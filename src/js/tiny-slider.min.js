/**
  * tiny-slider
  * @version 0.3.1
  * @author William Lin
  * @license The MIT License (MIT)
  * @github https://github.com/ganlanyuan/tiny-slider/
  * 
  * DEPENDENCIES:
  * firstElementChild, lastElementChild
  * addEventListener
  * extend
  * wrap
  * append
  * 
  */
!function(t){window.tinySlider=t()}(function(){"use strict";function t(t){return t*(180/Math.PI)}function i(t,i){return Math.abs(90-Math.abs(t))>=90-i?"horizontal":Math.abs(90-Math.abs(t))<=i?"vertical":!1}function e(t){return t&&"object"==typeof t?Object.keys(t):!1}function n(t,i){if(t&&"object"==typeof t){for(var e=[],n=0;n<i.length;n++){var s=i[n];e.push(t[s])}return e}return!1}function s(t,i,e){var n=document.documentElement.clientWidth;if(void 0===t.length||void 0===i||t.length!==i.length)return e;if(n<t[0])return e;if(n>=t[t.length-1])return i[i.length-1];for(var s=0;s<t.length-1;s++)if(n>=t[s]&&n<=t[s+1])return i[s]}function a(t){var i=document.querySelectorAll(t.container);if(0!==i.length)for(var e=i.length;e--;){var n=t;n.container=i[e];var s=new o(n)}}function o(a){a=gn.extend({container:".slider",items:1,fixedWidth:!1,maxContainerWidth:!1,slideByPage:!1,nav:!0,navText:["prev","next"],navContainer:!1,dots:!0,dotContainer:!1,arrowKeys:!1,speed:250,autoplay:!1,autoplayTimeout:5e3,autoplayDirection:"forward",loop:!0,responsive:!1,lazyload:!1,offset:0,touch:!0},a||{}),this.container=a.container,this.children=this.container.children,this.cl=this.cul=this.children.length,this.fw=a.fixedWidth,this.nav=a.nav,this.navText=a.navText,this.navContainer=a.navContainer,this.dots=a.dots,this.dotContainer=a.dotContainer,this.arrowKeys=a.arrowKeys,this.speed=r?a.speed:0,this.autoplay=a.autoplay,this.autoplayTimeout=a.autoplayTimeout,this.autoplayDirection="forward"===a.autoplayDirection?1:-1,this.loop=a.loop,this.slideByPage=a.slideByPage,this.responsive=this.fw?!1:a.responsive,this.lazyload=a.lazyload,this.touch=a.touch,this.bp=e(this.responsive),this.vals=n(this.responsive,this.bp),this.itemsMax=void 0!==this.vals.length?Math.max.apply(Math,this.vals):a.items,this.items=this.fw?Math.floor(this.container.parentNode.offsetWidth/this.fw):s(this.bp,this.vals,a.items),this.fw&&a.maxContainerWidth?this.itemsMax=Math.ceil(a.maxContainerWidth/this.fw):this.fw&&(this.loop=!1),this.itemsMax=Math.min(this.cl,this.itemsMax),this.items=Math.min(this.cl,this.items),this.dotsCount=this.dotContainer?this.cl:Math.ceil(this.cl/this.items),this.animating=!1,this.index=0,this.lazyload&&(this.offset=a.offset,this.viewport={},this.sliderRect={},this.viewport.top=0-this.offset,this.viewport.left=0-this.offset,this.inview=!1),this.touch&&(this.startX=0,this.startY=0,this.translateX=0,this.distX=0,this.distY=0,this.rt=0,this.panDir=!1,this.run=!1,this.animating=!1,this.slideEventAdded=!1),this.getAbsIndex=function(t){return t.index<0?t.index+t.cl:t.index>=t.cl?t.index-t.cl:t.index},this.setTransitionDuration=function(t,i){r&&(t.container.style[r]=t.speed*i/1e3+"s",t.animating=!0)},this.setDotCurrent=function(t){if(t.dotCurrent=t.dotContainer?t.getAbsIndex(t):Math.floor(t.getAbsIndex(t)/t.items),!t.loop&&!t.dotContainer){var i=/^-?[0-9]+$/,e=i.test(t.cl/t.items);e||t.index!==t.cl-t.items||(t.dotCurrent+=1)}},this.init=function(){this.container.classList.add("tiny-content");var t=document.createElement("div");if(t.className="tiny-slider",gn.wrap(this.container,t),navigator.msMaxTouchPoints){t.classList.add("ms-touch");var i=this;t.addEventListener("scroll",function(){r&&(i.container.style[r]="0s"),i.container.style.transform="translate3d(-"+-i.container.scrollLeft()+"px,0,0)"})}if(this.dots)if(this.dotContainer)this.allDots=this.dotContainer.children,this.allDots[0].classList.add("tiny-active");else{for(var e="",n=this.cl;n--;)e+='<div class="tiny-dot"></div>';e='<div class="tiny-dots">'+e+"</div>",gn.append(t,e),this.allDots=t.querySelectorAll(".tiny-dot")}if(this.nav&&(this.navContainer?(this.prev=this.navContainer.firstElementChild,this.next=this.navContainer.lastElementChild):(gn.append(t,'<div class="tiny-nav"><div class="tiny-prev">'+this.navText[0]+'</div><div class="tiny-next">'+this.navText[1]+"</div></div>"),this.prev=t.querySelector(".tiny-prev"),this.next=t.querySelector(".tiny-next"))),this.loop){for(var s=document.createDocumentFragment(),a=document.createDocumentFragment(),o=this.itemsMax;o--;){var l=this.children[o].cloneNode(!0),d=this.children[this.children.length-1-o].cloneNode(!0);s.insertBefore(l,s.firstChild),a.insertBefore(d,a.firstChild)}this.container.appendChild(s),this.container.insertBefore(a,this.container.firstChild),this.cul=this.container.children.length,this.children=this.container.children}var h=this;if(this.setDotCurrent(this),this.makeLayout(this),this.setSnapInterval(this),this.translate(this),this.itemActive(this),this.nav&&(this.disableNav(this),this.next.addEventListener("click",function(){h.onNavClick(h,1)}),this.prev.addEventListener("click",function(){h.onNavClick(h,-1)})),this.dots){this.dotContainer||(this.displayDots(this),this.dotActive(this));for(var n=0;n<this.allDots.length;n++)this.allDots[n].addEventListener("click",this.fireDotClick(this))}if(this.lazyload&&(this.saveViewport(this),this.sliderInView(this),this.lazyLoad(this)),this.arrowKeys&&document.addEventListener("keydown",function(t){t=t||window.event,37===t.keyCode?h.onNavClick(h,-1):39===t.keyCode&&h.onNavClick(h,1)}),this.autoplay&&setInterval(function(){h.onNavClick(h,h.autoplayDirection)},h.autoplayTimeout),this.touch){var c=this;!this.slideEventAdded&&this.container.addEventListener&&(this.container.addEventListener("touchstart",c.onPanStart(c),!1),this.container.addEventListener("touchmove",c.onPanMove(c),!1),this.container.addEventListener("touchend",c.onPanEnd(c),!1),this.container.addEventListener("touchcancel",c.onPanEnd(c),!1),this.slideEventAdded=!0)}},this.makeLayout=function(t){t.itemWidth=t.fw?t.fw:t.container.parentNode.offsetWidth/t.items,t.container.style.width=t.itemWidth*t.cul+"px";for(var i=0;i<t.cul;i++)t.children[i].style.width=t.itemWidth+"px";if(t.loop){var e=-(t.itemsMax*t.itemWidth);t.container.style.marginLeft=e+"px"}},this.setSnapInterval=function(t){navigator.msMaxTouchPoints&&(t.container.parentNode.style.msScrollSnapPointsX="snapInterval(0%, "+t.itemWidth+")")},this.itemActive=function(t){for(var i=t.loop?t.index+t.itemsMax:t.index,e=0;e<t.cul;e++)e===i?t.children[e].classList.add("tiny-current","tiny-visible"):e>i&&e<i+t.items?(t.children[e].classList.remove("tiny-current"),t.children[e].classList.add("tiny-visible")):t.children[e].classList.remove("tiny-current","tiny-visible")},this.disableNav=function(t){t.loop||(0===t.index?t.prev.classList.add("disabled"):t.prev.classList.remove("disabled"),t.index===t.cl-t.items?t.next.classList.add("disabled"):t.next.classList.remove("disabled"))},this.displayDots=function(t){for(var i=0;i<t.allDots.length;i++)i<t.dotsCount?t.allDots[i].classList.remove("tiny-hide"):t.allDots[i].classList.add("tiny-hide")},this.dotActive=function(t){if(t.dots)for(var i=0;i<t.dotsCount;i++)i===t.dotCurrent?t.allDots[i].classList.add("tiny-active"):t.allDots[i].classList.remove("tiny-active")},this.translate=function(t){var i=t.container.parentNode.offsetWidth,e;e=-t.itemWidth*t.index,t.fw&&!t.loop&&(e=Math.max(e,-(t.cul*t.itemWidth-i))),l?t.container.style[l]="translate3d("+e+"px, 0, 0)":t.container.style.left=e+"px"},this.fallback=function(t){if(t.loop){var i=t.slideByPage?t.index<-(t.itemsMax-t.items):t.index<=-t.itemsMax,e=t.slideByPage?t.index>t.cl+t.itemsMax-2*t.items-1:t.index>=t.cl+t.itemsMax-t.items;t.fw&&t.itemsMax&&!t.slideByPage&&(e=t.index>=t.cl+t.itemsMax-t.items-1),i&&(t.index+=t.cl),e&&(t.index-=t.cl),r&&(t.container.style[r]="0s"),t.translate(t)}},this.update=function(t){t.fallback(t),t.itemActive(t),t.disableNav(t),t.dotActive(t),t.lazyLoad(t),t.animating=!1},this.onNavClick=function(t,i){if(!t.animating){var e,n;i=t.slideByPage?i*t.items:i,n=Math.abs(i),e=t.index+i,t.index=t.loop?e:Math.max(0,Math.min(e,t.cl-t.items)),t.setTransitionDuration(t,n),t.translate(t),t.setDotCurrent(t),setTimeout(function(){t.update(t)},t.speed*n)}},this.fireDotClick=function(t){return function(){for(var i,e=0;e<t.allDots.length;e++)t.allDots[e]===this&&(i=e);t.onDotClick(t,i)}},this.onDotClick=function(t,i){if(!t.animating){var e,n;e=t.dotContainer?i:i*t.items,e=t.loop?e:Math.min(e,t.cl-t.items),n=Math.abs(e-t.index),t.index=e,t.setTransitionDuration(t,n),t.translate(t),t.dotCurrent=i,setTimeout(function(){t.update(t)},t.speed*n)}},this.saveViewport=function(t){t.viewport.bottom=document.documentElement.clientHeight+t.offset,t.viewport.right=document.documentElement.clientWidth+t.offset},this.sliderInView=function(t){var i=t.container.parentNode.getBoundingClientRect();t.sliderRect.left=i.left,t.sliderRect.right=i.right,t.sliderRect.top=i.top,t.sliderRect.bottom=i.bottom,t.inview=i.right>t.viewport.left&&i.bottom>t.viewport.top&&i.left<t.viewport.right&&i.top<t.viewport.bottom},this.elementInView=function(t,i){var e=t.getBoundingClientRect();return e.right>i.left&&e.bottom>i.top&&e.left<i.right&&e.top<i.bottom},this.lazyLoad=function(t){if(t.inview){var i=t.container.querySelectorAll(".tiny-lazy");if(i)for(var e=0;e<i.length;e++)t.elementInView(i[e],t.sliderRect)&&-1===i[e].className.indexOf("loaded")&&(i[e].src=i[e].getAttribute("data-src"),i[e].className+=" loaded")}},this.onPanStart=function(t){return function(i){var e=i.changedTouches[0];t.startX=parseInt(e.clientX),t.startY=parseInt(e.clientY)}},this.onPanMove=function(e){return function(n){var s=n.changedTouches[0];if(e.distX=parseInt(s.clientX)-e.startX,e.distY=parseInt(s.clientY)-e.startY,e.rt=t(Math.atan2(e.distY,e.distX)),e.panDir=i(e.rt,15),"horizontal"===e.panDir&&e.animating===!1&&(e.run=!0),e.run){r&&(e.container.style[r]="0s");var a=e.loop?-(e.cl+e.itemsMax-e.items)*e.itemWidth:-(e.cl-e.items)*e.itemWidth,o=e.loop?e.itemsMax*e.itemWidth:0;!e.loop&&e.fw&&(a=-(e.cl*e.itemWidth-e.container.parentNode.offsetWidth)),e.translateX=-e.index*e.itemWidth+e.distX,e.translateX=Math.max(a,Math.min(e.translateX,o)),l?e.container.style[l]="translate3d("+e.translateX+"px, 0, 0)":e.container.style.left=e.translateX+"px",n.preventDefault()}}},this.onPanEnd=function(t){return function(i){var e=i.changedTouches[0];if(t.distX=parseInt(e.clientX)-t.startX,t.run&&0!==t.distX){i.preventDefault(),t.run=!1,t.translateX=-t.index*t.itemWidth+t.distX;var n,s=t.loop?-t.itemsMax:0,a=t.loop?t.cl+t.itemsMax-t.items:t.cl-t.items;n=-(t.translateX/t.itemWidth),n=t.distX<0?Math.ceil(n):Math.floor(n),n=Math.max(s,Math.min(n,a)),t.index=n,t.setTransitionDuration(t,1),t.translate(t),t.setDotCurrent(t),setTimeout(function(){t.update(t)},t.speed)}}},this.init();var o=this,d;window.addEventListener("resize",function(){clearTimeout(d),d=setTimeout(function(){o.items=o.fw?Math.floor(o.container.parentNode.offsetWidth/o.fw):s(o.bp,o.vals,a.items),o.items=Math.min(o.cl,o.items),o.dotsCount=o.dotContainer?o.cl:Math.ceil(o.cl/o.items),o.speed=o.slideByPage?a.speed*o.items:a.speed,o.setDotCurrent(o),o.makeLayout(o),o.setSnapInterval(o),o.translate(o),o.dots&&!o.dotContainer&&(o.displayDots(o),o.dotActive(o)),o.lazyload&&(o.saveViewport(o),o.sliderInView(o),o.lazyLoad(o))},100)}),window.addEventListener("scroll",function(){o.lazyload&&(o.saveViewport(o),o.sliderInView(o),o.lazyLoad(o))})}var r=gn.getSupportedProp(["transitionDuration","WebkitTransitionDuration","MozTransitionDuration","OTransitionDuration"]),l=gn.getSupportedProp(["transform","WebkitTransform","MozTransform","OTransform"]);return a});